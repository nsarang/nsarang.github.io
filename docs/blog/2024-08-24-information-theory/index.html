<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.55">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nima Sarang">
<meta name="dcterms.date" content="2024-08-24">
<meta name="description" content="A brief overview of Information Theory concepts that I compiled for my own reference.">

<title>My Notes on Information Theory ‚Äì Nima Sarang</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../_assets/favicon.svg" rel="icon" type="image/svg+xml">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-HWSGHN8N8N"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-HWSGHN8N8N', { 'anonymize_ip': true});
</script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Source+Sans+3:wght@300;400;700&amp;display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Petrona:wght@400;500&amp;display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Red+Hat+Text:ital,wght@0,400;0,500;1,400;1,500&amp;display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=B612:ital,wght@0,400;0,700;1,400;1,700&amp;family=B612+Mono:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../_assets/docfuse/style.css">
<meta property="og:title" content="My Notes on Information Theory">
<meta property="og:description" content="A brief overview of Information Theory concepts that I compiled for my own reference.">
<meta property="og:image" content="https://www.nimasarang.com/blog/2024-08-24-information-theory/featured.png">
<meta property="og:site_name" content="Nima Sarang">
<meta property="og:image:height" content="666">
<meta property="og:image:width" content="1480">
<meta name="twitter:title" content="My Notes on Information Theory">
<meta name="twitter:description" content="A brief overview of Information Theory concepts that I compiled for my own reference.">
<meta name="twitter:image" content="https://www.nimasarang.com/blog/2024-08-24-information-theory/featured.png">
<meta name="twitter:image-height" content="666">
<meta name="twitter:image-width" content="1480">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../_assets/favicon.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Nima Sarang</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about/index.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../project/index.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../publication/index.html"> 
<span class="menu-text">Publications</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://www.github.com/nsarang" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
    <a href="https://www.linkedin.com/in/nima-sarang" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-linkedin"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns">
<div id="title-block-header-title" class="quarto-title page-columns page-full page-layout-full featured-image p-4" style="background-image: url(featured.png), url(featured.jpg), url(../featured.jpg); background-repeat: no-repeat;">
<h1 class="title">My Notes on Information Theory</h1>
</div>

<div>
  <div id="title-block-title-desc" class="description pt-4">
    A brief overview of Information Theory concepts that I compiled for my own reference.
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Nima Sarang </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 24, 2024</p>
    </div>
  </div>
  
    
  </div>
  



</header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#entropy" id="toc-entropy" class="nav-link" data-scroll-target="#entropy"><span class="header-section-number">2</span> Entropy</a>
  <ul class="collapse">
  <li><a href="#information-content" id="toc-information-content" class="nav-link" data-scroll-target="#information-content"><span class="header-section-number">2.1</span> Information Content</a></li>
  <li><a href="#shannon-entropy" id="toc-shannon-entropy" class="nav-link" data-scroll-target="#shannon-entropy"><span class="header-section-number">2.2</span> Shannon Entropy</a></li>
  <li><a href="#a-bit-of-history" id="toc-a-bit-of-history" class="nav-link" data-scroll-target="#a-bit-of-history"><span class="header-section-number">2.3</span> A bit of history</a></li>
  </ul></li>
  <li><a href="#cross-entropy" id="toc-cross-entropy" class="nav-link" data-scroll-target="#cross-entropy"><span class="header-section-number">3</span> Cross Entropy</a></li>
  <li><a href="#kullbackleibler-divergence" id="toc-kullbackleibler-divergence" class="nav-link" data-scroll-target="#kullbackleibler-divergence"><span class="header-section-number">4</span> Kullback‚ÄìLeibler Divergence</a>
  <ul class="collapse">
  <li><a href="#non-negativity" id="toc-non-negativity" class="nav-link" data-scroll-target="#non-negativity"><span class="header-section-number">4.1</span> Non-Negativity</a></li>
  <li><a href="#relations-to-mutual-information" id="toc-relations-to-mutual-information" class="nav-link" data-scroll-target="#relations-to-mutual-information"><span class="header-section-number">4.2</span> Relations to Mutual Information</a></li>
  </ul></li>
  <li><a href="#jensen-shannon-divergence" id="toc-jensen-shannon-divergence" class="nav-link" data-scroll-target="#jensen-shannon-divergence"><span class="header-section-number">5</span> Jensen-Shannon Divergence</a>
  <ul class="collapse">
  <li><a href="#js-vs-kl-at-zero-probabilities" id="toc-js-vs-kl-at-zero-probabilities" class="nav-link" data-scroll-target="#js-vs-kl-at-zero-probabilities"><span class="header-section-number">5.1</span> JS vs KL at Zero Probabilities</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">

<!-- source: https://github.com/gadenbuie/garrickadenbuie-com/blob/main/_partials/title-block-link-buttons/title-block.html -->
<!-- 
<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title"> 
-->
<!-- <header id="title-block-header" class="quarto-title-block default page-columns"> -->
<!-- <div class="quarto-title page-columns page-full featured-image p-4" style="background-image: url(featured.png), url(featured.jpg), url(../featured.jpg);"> -->



<div class="hidden">
% Meta %
<p>% Optional argument [#1]: Size modifier (e.g., , ) % #2: Opening delimiter % #3: Closing delimiter % #4: Content</p>
<p>% Common sets % Real numbers % Integers % Natural numbers % Rational numbers % Complex numbers</p>
<p>% Probability and statistics % Expectation % Variance % Covariance % Probability measure % Indicator function</p>
% Linear algebra
% Matrix
<p>% Vector % Trace % Rank % Range (image) % Projection</p>
% Calculus and analysis % For integrals, e.g., f(x) x
% Partial derivative \newcommand{[2]}{ #1} % Partial derivative w/o fraction
<p>% Second partial derivative % Gradient % Divergence % Curl</p>
% Set theory
% Set
<p>% Set builder notation % Union % Intersection % Symmetric difference</p>
<p>% Logic and proofs % Implies % If and only if % End of proof % Contradiction</p>
% Norms and inner products
% Norm
<p>% Inner product</p>
<p>% Common functions % Argument maximum % Argument minimum % Sign function % Span of a set</p>
% Formatting
% Absolute value
% Parentheses
% Brackets
% Floor function
<p>% Ceiling function</p>
<p>% Asymptotic notations % Big O notation % Small o notation % Big Omega notation % Big Theta notation</p>
<p>% Commonly used in algorithms and complexity % Polynomial time % Polylogarithmic time</p>
<p>% Additional probability notations % Independent and identically distributed % Distributed as</p>
<p>% Commonly used in optimization % Minimization problem % Maximization problem % Subject to constraints</p>
<p>% Fourier transform % Fourier transform % Inverse Fourier transform</p>
<p>% General math % Display style</p>
</div>
<section id="introduction" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>Every now and then, I find myself revisiting the basics of Information Theory when reading on papers about VAEs, GANs, or other generative models. I decided to compile a brief overview of the concepts for my own reference. Take it with a grain of salt, as it‚Äôs not meant to be a comprehensive guide.</p>
<p>I‚Äôll update this post as I learn more about the topic.</p>
</section>
<section id="entropy" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="entropy"><span class="header-section-number">2</span> Entropy</h2>
<p>Entropy is a fundamental concept in information theory that quantifies the uncertainty or randomness in a system. Let‚Äôs consider a couple of examples:</p>
<p>Imagine you‚Äôre trying to guess the next card drawn from a deck. With a well-shuffled deck, each draw is unpredictable ‚Äì this scenario has high entropy. On the other hand, if the cards were arranged in a known order, each draw would be predictable ‚Äì this has low entropy.</p>
<p>Now, let‚Äôs think about weather prediction. In a climate where it rains 90% of the days, predicting rain is usually correct but not very informative. This scenario has lower entropy than a climate where rain and sun are equally likely (50% each), making predictions more challenging and uncertain.</p>
<section id="information-content" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="information-content"><span class="header-section-number">2.1</span> Information Content</h3>
<p>We quantify the uncertainty or information content of an event <span class="math inline">\(x\)</span> with probability <span class="math inline">\(p(x)\)</span> as:</p>
<p><span class="math display">\[I(x) = -\log_2{p(x)}\]</span></p>
<p>It measures the surprise or ‚Äúnews value‚Äù of observing event <span class="math inline">\(x\)</span>. <span class="math inline">\(I(x)\)</span> is also reffered to as the number of bits needed to encode the event, but we‚Äôll get to that later.</p>
<p>Why use <span class="math inline">\(-\log p\)</span>? Let‚Äôs visualize it:</p>
<div id="cell-fig-log-ic" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">
<div id="fig-log-ic" class="quarto-float quarto-figure quarto-figure-center anchored" height="429" width="585">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-log-ic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-log-ic-output-1.png" id="fig-log-ic" width="585" height="429" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-log-ic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
</figcaption>
</figure>
</div>
</div>
</div>
<p>This function captures several intuitive properties:</p>
<ol type="1">
<li>Rare events (low <span class="math inline">\(p\)</span>) have higher information content, as <span class="math inline">\(\displaystyle{\lim_{p \to 0^+} (-\log{p}) = +\infty}.\)</span></li>
<li>Certain events (<span class="math inline">\(p = 1\)</span>) have zero information content.</li>
<li>The negative sign ensures positive information values.</li>
</ol>
</section>
<section id="shannon-entropy" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="shannon-entropy"><span class="header-section-number">2.2</span> Shannon Entropy</h3>
<p>Shannon entropy is the expected value (weighted average) of information content across all possible events in a probability distribution:</p>
<p><span id="eq-entropy"><span class="math display">\[H(X) = \mathbb{E}[-\log p(X)] = -\sum_x p(x) \log{p(x)} \tag{1}\]</span></span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>If <span class="math inline">\(p(x) = 0\)</span>, we define <span class="math inline">\(0 \log{0} = 0\)</span> since <span class="math inline">\(\displaystyle{\lim_{p \to 0^+} p\log{p} = 0}\)</span> and can be proven using L‚ÄôH√¥pital‚Äôs rule.</p>
</div>
</div>
</div>
<p>To put this into perspective, English text typically has an entropy of about 1-1.5 bits per character. In comparison, a random string of characters over the same alphabet has an entropy of <span class="math display">\[\mathbb{E}[-\log_2{p(X)}] = -\sum\limits_{i=1}^{26} \frac{1}{26} \log_2(\frac{1}{26}) = \log_2(26) \approx 4.7\]</span> bits per character.</p>
<p>This concept has practical applications in various fields. For instance, in cybersecurity, a truly random string of characters (like a strong password) approaches the maximum entropy of <span class="math inline">\(\log_2(n)\)</span> bits per character, where <span class="math inline">\(n\)</span> is the number of possible characters. The password ‚Äúpassword123‚Äù has low entropy and is easily guessable, while ‚ÄúTr0ub4dor&amp;Co‚Äù has higher entropy and is more secure. This difference in entropy reflects the varying degrees of unpredictability and, consequently, the strength of these passwords.</p>
</section>
<section id="a-bit-of-history" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="a-bit-of-history"><span class="header-section-number">2.3</span> A bit of history</h3>
<p>The terms ‚Äúcoding‚Äù and ‚Äúencoded‚Äù in information theory stem from Claude Shannon‚Äôs work on efficient information transmission over noisy channels. Entropy <span class="math inline">\(H(X)\)</span> represents the theoretical lower bound on the average number of bits needed to encode symbols from a source, which is why we measure it in bits (using log base 2) - it directly relates to optimal coding length.</p>
<p>Shannon‚Äôs Source Coding Theorem formalizes this: no lossless compression can exceed this efficiency on average. This explains why English text (~1.5 bits of entropy per character) compresses far more than random text (~4.7 bits per character), and why compression algorithms excel with natural language but struggle with random data. Understanding entropy as a limit on coding efficiency makes it a powerful tool across various domains like data compression, cryptography, and machine learning.</p>
</section>
</section>
<section id="cross-entropy" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="cross-entropy"><span class="header-section-number">3</span> Cross Entropy</h2>
<p>Imagine you have a source that produces messages according to a true distribution <span class="math inline">\(P\)</span>, but you‚Äôre using a different distribution <span class="math inline">\(Q\)</span> to encode these messages. Cross-entropy measures the average number of bits you‚Äôll need using this possibly inefficient encoding.</p>
<p>For example, consider describing a language you‚Äôve never seen before. You start by guessing how often each letter appears.</p>
<ul>
<li>The true frequency (<span class="math inline">\(P\)</span>) of letters in this language is: <span class="math inline">\(A: 40\%, \; B: 40\%, \; C: 20\%\)</span></li>
<li>Your initial guess (<span class="math inline">\(Q\)</span>) is: <span class="math inline">\(A: 60\%, \; B: 30\%, \; C: 10\%\)</span></li>
</ul>
<p>Now, let‚Äôs use your guess to ‚Äúencode‚Äù messages in this language, i.e., calculate its uncertainty:</p>
<ol type="1">
<li>For each ‚ÄòA‚Äô, we use <span class="math inline">\(-\log_2{0.6} \approx 0.74\)</span> bits</li>
<li>For each ‚ÄòB‚Äô, we use <span class="math inline">\(-\log_2{0.3} \approx 1.74\)</span> bits</li>
<li>For each ‚ÄòC‚Äô, we use <span class="math inline">\(-\log_2{0.1} \approx 3.32\)</span> bits</li>
</ol>
<p>To calculate the average number of bits per letter, we use <span class="math inline">\(P\)</span>‚Äôs frequencies because that‚Äôs how often each letter actually appears, while <span class="math inline">\(Q\)</span> determines the cost for each letter. This combination tells us the real-world performance of our encoding scheme.</p>
<p><span class="math display">\[ 0.4 \times 0.74 + 0.4 \times 1.74 + 0.2 \times 3.32 \approx 1.57 \text{ bits per letter}\]</span></p>
<p>The resulting average, <span class="math inline">\(H(P,Q) \approx 1.57\)</span> bits, represents the typical encoding cost per letter when our guess (<span class="math inline">\(Q\)</span>) is used to encode messages that actually follow the true distribution (<span class="math inline">\(P\)</span>).</p>
<p>This approach mirrors how we evaluate predictions in ML: Our model makes guesses (Q), but the world behaves according to the true probabilities (P). Cross-entropy quantifies the average encoding length under this scenario.</p>
<p><strong>Formal Definition:</strong></p>
<p>The cross-entropy between two probability distributions <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> over the same underlying set of events measures the average number of bits needed to identify an event drawn from the set, if a coding scheme used for the set is optimized for an estimated probability distribution <span class="math inline">\(q\)</span>, rather than the true distribution <span class="math inline">\(p\)</span>.</p>
<p><span id="eq-cross-entropy"><span class="math display">\[H(P, Q) = -\sum\limits_{x \in X} p(x)\log{q(x)} = \mathbb{E}_{x \sim P}[-\log{q(x)}] \tag{2}\]</span></span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>If <span class="math inline">\(p(x) &gt; 0\)</span> and <span class="math inline">\(q(x) = 0\)</span> for some <span class="math inline">\(x\)</span>, then <span class="math inline">\(p(x)\log{q(x)}\)</span> is undefined. To address this we can add a small epsilon to <span class="math inline">\(q(x)\)</span> to avoid <span class="math inline">\(\log{0}\)</span>. In fact, this is a common practice in ML libraries.</p>
</div>
</div>
</div>
<p><strong>Binary Cross-Entropy:</strong></p>
<ul>
<li><p>In binary classification, we deal with two classes, and the predicted probability for one class inherently determines the probability for the other. If <span class="math inline">\(q\)</span> is the predicted probability of the positive class (class 1), then <span class="math inline">\(1-q\)</span> is the probability of the negative class (class 0). The binary cross-entropy loss combines the log-likelihood terms for both possible classes (positive and negative) into a single expression. For a single data point, it is defined as:</p>
<p><span class="math display">\[-\left[y\,log(q)\;+\;(1‚àíy)\,log(1‚àíq)\right]\]</span></p></li>
</ul>
</section>
<section id="kullbackleibler-divergence" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="kullbackleibler-divergence"><span class="header-section-number">4</span> Kullback‚ÄìLeibler Divergence</h2>
<p>To measure the expected number of extra bits required to code samples from <span class="math inline">\(P\)</span> using a code optimized for <span class="math inline">\(Q\)</span> rather than the code optimized for <span class="math inline">\(P\)</span>, we use the Kullback-Leibler divergence. It</p>
<p><span id="eq-kl-divergence"><span class="math display">\[
\begin{aligned}
D_{KL}(P \;\Vert\; Q) &amp;= H(P, Q) - H(P) &amp;&amp; \text{\small{(extra bits needed to code $P$ using $Q$)}} \\[3ex]
&amp;= \mathbb{E}_{x \sim P}[-\log q(x)] - \mathbb{E}_{x \sim P}[-\log p(x)] \\[3ex]
&amp;= -\sum\limits_{x \in X} p(x)\log{q(x)} + \sum\limits_{x \in X} p(x)\log{p(x)} \\[1ex]
&amp;= \sum\limits_{x \in X} p(x)\log{\frac{p(x)}{q(x)}} &amp;&amp; \text{\small{(as $\log{a} - \log{b} = \log{\frac{a}{b}}$)}}
\end{aligned}
\tag{3}\]</span></span></p>
<p>The relative entropy <span class="math inline">\({D_{\text{KL}}(P\parallel Q)}\)</span> quantifies how far the distribution <span class="math inline">\(Q\)</span> is from the distribution <span class="math inline">\(P\)</span>. The cross-entropy alone cannot be thought of as a distance, since <span class="math inline">\({H(P,P)=:H(P)}\)</span> isn‚Äôt zero. This can be fixed by subtracting <span class="math inline">\({H(P)}\)</span> to make <span class="math inline">\({D_{\text{KL}}(P\parallel Q)}\)</span> agree more closely with our notion of distance, as the <em>excess loss</em>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>KL divergence is asymmetric, i.e.&nbsp;<span class="math inline">\({D_{\text{KL}}(P\parallel Q)\neq D_{\text{KL}}(Q\parallel P)}\)</span> except when <span class="math inline">\(P = Q\)</span>.</p>
</div>
</div>
</div>
<section id="non-negativity" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="non-negativity"><span class="header-section-number">4.1</span> Non-Negativity</h3>
<p>If <span class="math inline">\(Q = P\)</span>, then <span class="math inline">\(D_{KL}(P \;\Vert\; P) = H(P, P) - H(P) = 0\)</span>. But is zero the lower bound for <span class="math inline">\(D_{KL}\)</span>? Basically the question is whether: <span class="math display">\[H(P, Q) \stackrel{?}{\geq} H(P) \quad \forall P, Q\]</span></p>
<p>This is known as Gibbs‚Äô inequality, and it‚Äôs a fundamental property of the Kullback-Leibler divergence. It tells us that if you try to use a probability distribution <span class="math inline">\(Q\)</span> to encode data that actually follows a different distribution <span class="math inline">\(P\)</span>, you will always need more bits on average, compared to using <span class="math inline">\(P\)</span> itself.</p>
<p>To prove <span class="math inline">\(D_{KL}(P \;\Vert\; Q) \stackrel{?}{\ge} 0\)</span>, we can use the fact that <span class="math inline">\(-\log\)</span> is a convex function (see <a href="#fig-log-ic" class="quarto-xref">Figure&nbsp;1</a>). By Jensen‚Äôs inequality, we have:</p>
<p><span class="math display">\[
\begin{aligned}
\sum\limits_{x} p(x)\log{\frac{p(x)}{q(x)}} &amp;= \sum\limits_{x} p(x)\times -\log{\frac{q(x)}{p(x)}} \\[2ex]
&amp;\ge -\log\left(\sum_{x} p(x) {\frac{q(x)}{p(x)}}\right) &amp;&amp; \text{\small{(Jensen's inequality)}} \\[2ex]
&amp;= -\log\left(\sum_{x} q(x)\right) = -\log {1} &amp;&amp; \text{\small{(sum of probabilities = 1)}} \\[2ex]
&amp; = 0
\end{aligned}
\]</span> <span class="math display">\[ \therefore \quad D_{KL}(P \;\Vert\; Q) \ge 0\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Jensen‚Äôs Inequality
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Jensen‚Äôs inequality states that for a convex function <span class="math inline">\(f\)</span> and a random variable <span class="math inline">\(X\)</span>:</p>
<p><span class="math display">\[f(\mathbb{E}[X]) \leq \mathbb{E}[f(X)]\]</span></p>
<p>Similarly, for a concave function <span class="math inline">\(f\)</span>: <span class="math display">\[f(\mathbb{E}[X]) \geq \mathbb{E}[f(X)]\]</span></p>
</div>
</div>
</div>
</section>
<section id="relations-to-mutual-information" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="relations-to-mutual-information"><span class="header-section-number">4.2</span> Relations to Mutual Information</h3>
<p>Let <span class="math inline">\((X,Y)\)</span> be a pair of random variables with values over the space <span class="math inline">\({\mathcal {X}}\times {\mathcal {Y}}\)</span>. If their joint distribution is <span class="math inline">\({P_{(X,Y)}}\)</span> and the marginal distributions are <span class="math inline">\({P_{Y}}\)</span> and <span class="math inline">\({P_{Y}}\)</span>, the mutual information is defined as:</p>
<p><span id="eq-mutual-information"><span class="math display">\[{I(X;Y)=D_{\mathrm {KL} }(P_{(X,Y)}\|P_{X}P_{Y})} \tag{4}\]</span></span></p>
<p>Notice, as per property of the KL divergence that <span class="math inline">\(I(X;Y)\)</span> is equal to zero precisely when the joint distribution coincides with the product of the marginals, i.e.&nbsp;when <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are independent (and hence observing <span class="math inline">\(Y\)</span> tells you nothing about <span class="math inline">\(X\)</span>). Intuitively, <span class="math inline">\(I(X;Y)\)</span> is a measure of the price for encoding <span class="math inline">\((X,Y)\)</span> as a pair of independent random variables when in reality they may not be.</p>
<p>Mutual information can also be expressed using conditional entropy:</p>
<p><span class="math display">\[{I(X;Y) \equiv H(X) - H(X \vert Y)}\]</span></p>
<p><br></p>
<p>Check out this video for a more detailed explanation: <a href="https://www.youtube.com/watch?v=RaTe3dhiqdE">A RIDICULOUSLY AWESOME SUMMATION: Mutual Information and Kullback-Leibler Divergence</a></p>
</section>
</section>
<section id="jensen-shannon-divergence" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="jensen-shannon-divergence"><span class="header-section-number">5</span> Jensen-Shannon Divergence</h2>
<p>JS divergence is a symmetric measure, derived from KL divergence, and it does satisfy the properties of a metric. It is defined as the average of the KL divergence from each distribution to the average of both distributions:</p>
<p><span id="eq-js-divergence"><span class="math display">\[{JS(P \;\Vert\; Q) = \frac{1}{2}KL(P \;\Vert\; M) + \frac{1}{2}KL(Q \;\Vert\; M)} \tag{5}\]</span></span></p>
<p>where <span class="math inline">\(M=\dfrac{1}{2} (P+Q)\)</span> is a mixture of <span class="math inline">\(P\)</span> and <span class="math inline">\(Q\)</span>.</p>
<section id="js-vs-kl-at-zero-probabilities" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="js-vs-kl-at-zero-probabilities"><span class="header-section-number">5.1</span> JS vs KL at Zero Probabilities</h3>
<p><strong>KL Divergence</strong></p>
<ol type="1">
<li><p><span class="math inline">\(p(ùëã)=0 \text{ and } q(ùëã)\gt 0\)</span>:<br>
Then <span class="math inline">\(\displaystyle\lim_{p \to 0} p\log{p} = 0\)</span>. Since we sample according to <span class="math inline">\(p\)</span>, we will never sample event <span class="math inline">\(x\)</span>. Hence, it does not weight in <span class="math inline">\({D_{KL}(P \;\Vert\; Q)}\)</span>. This means <span class="math inline">\(Q\)</span> can make mistakes about events that <span class="math inline">\(P\)</span> considers impossible without penalty.<br></p></li>
<li><p><span class="math inline">\(p(ùëã)\gt 0 \text{ and } q(ùëã)= 0\)</span>:<br>
Then&nbsp;<span class="math inline">\(\displaystyle\lim_{q \to 0^+} \log{\frac{1}{q}} = +\infty\)</span>. An infinite divergence effectively signals that the model <span class="math inline">\(Q\)</span> fails to account for an event <span class="math inline">\(x\)</span> that is observed under <span class="math inline">\(P\)</span>.<br></p></li>
<li><p><span class="math inline">\(p(ùëã)=0 \text{ and } q(ùëã)= 0\)</span>: Then it‚Äôs really undefined :)</p></li>
</ol>
<p><br></p>
<p><strong>JS Divergence</strong></p>
<p>The averaging process and the introduction of <span class="math inline">\(M\)</span> ensure that the divergence remains finite, even if one distribution assigns zero probability to an event that the other distribution assigns a positive probability.</p>
<p>This can be a desirable property in scenarios where you want a more stable and bounded measure of divergence. However, it also means that JS divergence is less sensitive to cases where one distribution completely ignores an event that the other considers possible.</p>


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{sarang2024,
  author = {Sarang, Nima},
  title = {My {Notes} on {Information} {Theory}},
  date = {2024-08-24},
  url = {https://www.nimasarang.com/blog/2024-08-24-information-theory/},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-sarang2024" class="csl-entry quarto-appendix-citeas" role="listitem">
<div class="">N.
Sarang, <span>‚ÄúMy Notes on Information Theory.‚Äù</span> [Online].
Available: <a href="https://www.nimasarang.com/blog/2024-08-24-information-theory/">https://www.nimasarang.com/blog/2024-08-24-information-theory/</a></div>
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("^(?:http:|https:)\/\/(?:www\.)?(nimasarang\.com)\/.*$");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="nsarang/nsarang.github.io" data-repo-id="R_kgDOMZYgPg" data-category="Announcements" data-category-id="DIC_kwDOMZYgPs4ChVIN" data-mapping="pathname" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" data-loading="lazy" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2024, Nima Sarang</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>
<script src="../../_assets/docfuse/render.js"></script>




</body></html>